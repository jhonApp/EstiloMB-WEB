@using EstiloMB.Core
@using EstiloMB.MVC;
@using EstiloMB.Site;
@addTagHelper *, MyWebApp
@{
    ViewData["Title"] = "";
    Layout = "~/Views/Shared/_Layout.cshtml";

    IList<Produto> listProdutos = Produto.Listar(new Request<Produto>() { UserID = Usuario.EstiloMbID })?.Data;
}
<section>
    <div class="slider">
        <div class="slides">

            <input type="radio" name="radio-btn" id="radio1"/>
            <input type="radio" name="radio-btn" id="radio2"/>
            <input type="radio" name="radio-btn" id="radio3"/>
                

            <div class="slide first">
                <img src=~/image/look.jpg alt="" />
            </div>
            <div class="slide">
                <img src=~/image/jeans.jpg alt="" />
            </div>
            <div class="slide">
                <img src=~/image/tp231-presentation-04-383.jpg alt="" />
            </div>

            <div class="navigation-auto">
                <div class="auto-btn1"></div>
                <div class="auto-btn2"></div>
                <div class="auto-btn3"></div>
            </div>

        </div>

        <div class="manual-navigation">
            <label for="radio1" class="manual-btn"></label>
            <label for="radio2" class="manual-btn"></label>
            <label for="radio3" class="manual-btn"></label>
        </div>
    </div>
</section>
<content>
    <div class="colsWeb">
        <div class="search">
            <div class="content">
                <div> <i class="fas fa-search icon"></i> </div>
                <input type="text" id="search" data-bind="" placeholder="O que você está procurando?"/>
            </div>
        </div>
    </div>
    <div class="colsWeb">
        <h2 class="product-category">Destaques</h2>
        <div class="swiper destaques">
            <div class="swiper-wrapper product-container">
                @foreach (var produto in listProdutos)
                {
                    @*------------------------ Produto -------------------------*@
                    <div class=" swiper-slide product-card" style="width: 250px;">
                        <div class="product-image">
                            <span class="discount-tag">50% off</span>
                            <span class="discount-heart">
                                <input type="checkbox" />
                                <i class="fas fa-heart icon"></i>
                            </span>

                            <img src="~/Produtos/@produto.ProdutoImagens[0].ImageURL" class="product-thumb" />
                            <input type="hidden" name="ID" value="@produto.ID">
                            <button class="card-btn" onclick="$produto.detalhes(this)">Mais Detalhes</button>
                        </div>
                        <div class="product-info">
                            <h2 class="product-brand">@produto.Nome</h2>
                            <p class="product-short-description">@produto.Descricao</p>
                            <span class="price">R$ @produto.Valor</span>
                            <span class="actual-price">R$50,00</span>
                        </div>
                    </div>
                }
            </div>
        </div>
        <button class="button-prev pre-btn"></button>
        <button class="button-next nxt-btn"></button>
    </div>
    <div class="colsWeb">
        <h2 class="product-category">Promoções</h2>
        <div class="swiper promocoes">
            <div class=" swiper-wrapper product-container">
                @*----------------------- Produto 5 -------------------*@
                <div class=" swiper-slide product-card" style="width: 250px;">
                    <div class="product-image">
                        <span class="discount-tag">50% off</span>
                        <span class="discount-heart">
                            <input type="checkbox" />
                            <i class="fas fa-heart icon"></i>
                        </span>

                        <img src="~/image/vertical-photo1.jpg" class="product-thumb" />
                        <button class="card-btn"><a href="~/Produto/Details">Mais Detalhes</a></button>
                    </div>
                    <div class="product-info">
                        <h2 class="product-brand">brand</h2>
                        <p class="product-short-description">a short line about the product</p>
                        <span class="price">R$120,00</span>
                        <span class="actual-price">R$50,00</span>
                    </div>
                </div>
                @*----------------------- Produto 5 -------------------*@
                <div class=" swiper-slide product-card" style="width: 250px;">
                    <div class="product-image">
                        <span class="discount-tag">50% off</span>
                        <span class="discount-heart">
                            <input type="checkbox" />
                            <i class="fas fa-heart icon"></i>
                        </span>

                        <img src="~/image/vertical-photo1.jpg" class="product-thumb" />
                        <button class="card-btn">Mais Detalhes</button>
                    </div>
                    <div class="product-info">
                        <h2 class="product-brand">brand</h2>
                        <p class="product-short-description">a short line about the product</p>
                        <span class="price">R$120,00</span>
                        <span class="actual-price">R$50,00</span>
                    </div>
                </div>
                @*----------------------- Produto 5 -------------------*@
                <div class=" swiper-slide product-card" style="width: 250px;">
                    <div class="product-image">
                        <span class="discount-tag">50% off</span>
                        <span class="discount-heart">
                            <input type="checkbox" />
                            <i class="fas fa-heart icon"></i>
                        </span>

                        <img src="~/image/vertical-photo1.jpg" class="product-thumb" />
                        <button class="card-btn">Mais Detalhes</button>
                    </div>
                    <div class="product-info">
                        <h2 class="product-brand">brand</h2>
                        <p class="product-short-description">a short line about the product</p>
                        <span class="price">R$120,00</span>
                        <span class="actual-price">R$50,00</span>
                    </div>
                </div>
                @*----------------------- Produto 5 -------------------*@
                <div class=" swiper-slide product-card" style="width: 250px;">
                    <div class="product-image">
                        <span class="discount-tag">50% off</span>
                        <span class="discount-heart">
                            <input type="checkbox" />
                            <i class="fas fa-heart icon"></i>
                        </span>

                        <img src="~/image/vertical-photo1.jpg" class="product-thumb" />
                        <button class="card-btn">Mais Detalhes</button>
                    </div>
                    <div class="product-info">
                        <h2 class="product-brand">brand</h2>
                        <p class="product-short-description">a short line about the product</p>
                        <span class="price">R$120,00</span>
                        <span class="actual-price">R$50,00</span>
                    </div>
                </div>
                @*----------------------- Produto 5 -------------------*@
                <div class=" swiper-slide product-card" style="width: 250px;">
                    <div class="product-image">
                        <span class="discount-tag">50% off</span>
                        <span class="discount-heart">
                            <input type="checkbox" />
                            <i class="fas fa-heart icon"></i>
                        </span>

                        <img src="~/image/vertical-photo1.jpg" class="product-thumb" />
                        <button class="card-btn">Mais Detalhes</button>
                    </div>
                    <div class="product-info">
                        <h2 class="product-brand">brand</h2>
                        <p class="product-short-description">a short line about the product</p>
                        <span class="price">R$120,00</span>
                        <span class="actual-price">R$50,00</span>
                    </div>
                </div>
                @*----------------------- Produto 5 -------------------*@
                <div class=" swiper-slide product-card" style="width: 250px;">
                    <div class="product-image">
                        <span class="discount-tag">50% off</span>
                        <span class="discount-heart">
                            <input type="checkbox" />
                            <i class="fas fa-heart icon"></i>
                        </span>

                        <img src="~/image/vertical-photo1.jpg" class="product-thumb" />
                        <button class="card-btn">Mais Detalhes</button>
                    </div>
                    <div class="product-info">
                        <h2 class="product-brand">brand</h2>
                        <p class="product-short-description">a short line about the product</p>
                        <span class="price">R$120,00</span>
                        <span class="actual-price">R$50,00</span>
                    </div>
                </div>
            </div>
        </div>
        <button class="swiper-button-prev pre-btn"></button>
        <button class="swiper-button-next nxt-btn"></button>
        @*<div class="swiper-pagination"></div>*@
    </div>
</content>
<script type="text/javascript">

    (function($produto) {

        $produto.detalhes = function(element) {

            let ID = element.closest('.product-image').querySelector("[name=ID]").value;
            window.location.href = "Produto/Details?produtoID=" + ID;
            console.log(window.location.href);

            $min.ajax({
                url: $min.root() + $ui.relativePath + 'Produto/GetbyID?produtoID=' + ID,
                headers: {
                    "Content-Type": "application/json",
                    "X-XSRF-TOKEN": $min.getCookie("XSRF-TOKEN")
                },
                onsuccess: function(produto) {
                    let obj = {
                        ID: produto.ID,
                        Nome: produto.Nome,
                        Descricao: produto.Descricao,
                        Valor: produto.Valor,
                        ProdutoImagens: produto.ProdutoImagens,
                        ProdutoTamanhos: produto.ProdutoTamanhos,
                        ProdutoCategorias: produto.ProdutoCategorias,
                    };

                    console.log(obj);
                },
                onfailure: function(httpCode, httpMessage) {
                    if (httpCode === 401) {
                        let currentURL = window.location.href.replace($min.root() + $ui.relativePath, "");
                        window.location.href = $min.root() + $ui.relativePath + $ui.redirectLoginURL + currentURL;
                    }
                    $ui.message(httpMessage, "error");
                }
            });
            
            //console.log(obj)
            //let popup = template.closest('section').querySelector('#produto');
            //$min.bind(popup, obj);
            //imageEmpty(obj)
        };
    })(window.$produto = window.$produto || {});

    var swiper = new Swiper(".destaques", {
        slidesPerView: 4,
        spaceBetween: 30,
        slidesPerGroup: 4,
        loop: true,
        loopFillGroupWithBlank: true,
        pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
        navigation: {
          nextEl: ".button-next",
          prevEl: ".button-prev",
        },
      });

    var swiper = new Swiper(".promocoes", {
        slidesPerView: 4,
        spaceBetween: 30,
        slidesPerGroup: 4,
        loop: true,
        loopFillGroupWithBlank: true,
        pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
        navigation: {
          nextEl: ".swiper-button-next",
          prevEl: ".swiper-button-prev",
        },
      });
</script>
